package com.example.demo.models;

import java.util.List;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.OneToMany;
import javax.persistence.Table;

import com.fasterxml.jackson.annotation.JsonIgnore;

import io.swagger.v3.oas.annotations.media.Schema;

@Entity
@Table(name = "saldosdivisas")
public class SaldoDivisa {

	public SaldoDivisa(Long billeteraId, String divisaTipo, Billetera billetera) {
		this.billeteraId = billeteraId;
		this.divisaTipo = divisaTipo;
		this.divisaSaldo = 0;
		this.billetera = billetera;
	}

	public SaldoDivisa() {
	}

	@Schema(hidden = true)
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	@Column(name = "saldosid")
	private Long saldoId;

	@Column(name = "billeteraid")
	private Long billeteraId;

	@Column(name = "divisatipo")
	private String divisaTipo;

	@Column(name = "divisasaldo")
	private float divisaSaldo;

	@ManyToOne(fetch = FetchType.LAZY)
	@JoinColumn(name = "billeteraid", nullable = false)
	private Billetera billetera;

	@OneToMany(mappedBy = "divisas", cascade = CascadeType.ALL)
	private List<Divisa> divisas;
	
	public List<Divisa> getDivisas() {
		return divisas;
	}

	public void setDivisas(List<Divisa> divisas) {
		this.divisas = divisas;
	    for(Divisa txn : divisas) {
	      txn.setSaldoDivisa(this);
	    }
		this.divisas = divisas;
	}

	@JsonIgnore
	public Billetera getBilletera() {
		return billetera;
	}

	public void setBilletera(Billetera billetera) {
		this.billetera = billetera;
	}

	public Long getSaldoId() {
		return saldoId;
	}

	public void setSaldoId(Long saldoId) {
		this.saldoId = saldoId;
	}

	public Long getBilleteraId() {
		return billeteraId;
	}

	public void setBilleteraId(Long billeteraId) {
		this.billeteraId = billeteraId;
	}

	public String getDivisaTipo() {
		return divisaTipo;
	}

	public void setDivisaTipo(String divisaTipo) {
		this.divisaTipo = divisaTipo;
	}

	public float getDivisaSaldo() {
		return divisaSaldo;
	}

	public void setDivisaSaldo(float divisaSaldo) {
		this.divisaSaldo += divisaSaldo;
	}

	/*public String toString() {
		StringBuilder json = new StringBuilder();
		json.append("{\"" + this.getDivisaTipo() + "\": \"" + this.getDivisaSaldo() + "\"}");
		return json.toString();
	}*/
}
